import{_ as F,a as q}from"./CTy8_DAc.js";import{f as N,y as f,r as D,o as c,c as u,a,b as n,k as t,l as V,w as k,q as j,ad as m,B as b,v as $,ac as E,ae as R,t as h,d as z,x as I}from"./iBiA3qHo.js";import{_ as M}from"./M2xpECKh.js";import{g as G,h as H}from"./BLDARQqd.js";import{s as A}from"./BoJhwiBp.js";import{_ as J}from"./izpi8Ziy.js";import{_ as K}from"./DU3fwEm4.js";import{_ as O}from"./BY08tY9k.js";import{_ as Q}from"./DkZjKyQf.js";const W={class:"flex size-full flex-col overflow-hidden p-4 pt-2 md:p-6"},X={class:"hidden flex-wrap items-center justify-between gap-2 md:relative md:flex"},Y={class:"flex items-center gap-2 pb-2 md:py-4 md:pb-4"},Z=["onClick"],ee={class:"relative flex gap-4"},se={key:0,class:"absolute -right-2 -top-2"},oe=["src"],te=["onClick"],ae=["onClick"],ne={class:""},le={class:"line-clamp-1 font-medium"},ie={key:0,class:"mt-1 line-clamp-2 text-xs text-foreground/60"},re={key:1,class:"mt-1 line-clamp-2 text-xs text-foreground/60"},de={class:"mt-1 line-clamp-2 flex items-center gap-1 text-xs text-foreground/60"},ce={class:"fixed"},xe=N({__name:"records",setup(ue,{expose:U}){const g=f(),v=f(),r=f(),x=f(),d=D(""),y=o=>{var e;(e=r.value)==null||e.getList({newParams:{keyword:o},resetPage:!0})},S=o=>{var p;const e=["",1,0,2];(p=r.value)==null||p.getList({newParams:{status:e[o]},resetPage:!0})},w=()=>{var o,e;(o=r.value)==null||o.getList(),(e=r.value)==null||e.startPolling()};return U({refresh:w}),(o,e)=>{const p=F,B=q,T=j,_=I,L=M;return c(),u("div",W,[a("div",X,[e[4]||(e[4]=a("h1",{class:"text-lg font-medium leading-none md:text-2xl"},"合成记录",-1)),n(p,{modelValue:t(d),"onUpdate:modelValue":e[0]||(e[0]=s=>V(d)?d.value=s:null),onSearch:y},null,8,["modelValue"])]),a("div",Y,[n(B,{class:"w-full overflow-hidden sm:w-fit",ui:{container:"hidden",list:{tab:{padding:"px-0 sm:px-6",active:"text-primary dark:text-white"}}},items:[{label:"全部"},{label:"完成"},{label:"合成中"},{label:"失败"}],onChange:S}),n(p,{modelValue:t(d),"onUpdate:modelValue":e[1]||(e[1]=s=>V(d)?d.value=s:null),class:"md:hidden",onSearch:y},null,8,["modelValue"]),n(T,{class:"ml-auto h-full rounded-lg md:h-auto md:rounded-full",ui:{rounded:"rounded-full",padding:{sm:"px-4"}},icon:"i-tabler:upload",onClick:e[2]||(e[2]=s=>{var i;return(i=t(v))==null?void 0:i.show()})},{default:k(()=>e[5]||(e[5]=[a("span",{class:"md:hidden"},"本地",-1),a("span",{class:"hidden md:block"},"本地上传",-1)])),_:1})]),n(K,{ref_key:"listRef",ref:r,"request-instance":t(H),scroll:!0,polling:s=>s.filter(i=>("isTaskPendding"in o?o.isTaskPendding:t(m))(i.status)).length===0,class:"grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4"},{default:k(({item:s})=>{var i;return[a("div",{class:$(["group relative flex-1 cursor-pointer rounded-lg bg-background-soft p-4 shadow-none md:rounded-xl lg:block",{"!cursor-not-allowed":("isTaskPendding"in o?o.isTaskPendding:t(m))(s.status),"bg-red-50 opacity-50 dark:bg-background-soft":("isTaskFail"in o?o.isTaskFail:t(R))(s.status)}]),padding:"p-4"},[a("div",{class:"absolute bottom-2 right-2 z-10 opacity-0 transition-opacity group-hover:opacity-100",onClick:C=>{var l;(l=t(x))==null||l.open({message:`确认要删除 《${s.title}》 吗？`,title:"删除音色",confirm:async()=>{var P;await t(G)({id:s.id}),(P=t(r))==null||P.getList()}})}},[n(T,{icon:"tabler:trash",color:"red",ui:{rounded:"rounded-full"},size:"2xs"})],8,Z),a("div",ee,[("isTaskPendding"in o?o.isTaskPendding:t(m))(s.status)?(c(),u("div",se,[n(_,{name:"tabler:loader-2",class:"animate-spin text-primary"})])):b("",!0),a("div",{class:$(["audio-container relative h-14 w-14 flex-shrink-0",{"opacity-80":("isTaskPendding"in o?o.isTaskPendding:t(m))(s.status)}])},[a("img",{src:((i=s.timbre)==null?void 0:i.cover)||s.cover||t(A),class:"relative size-full rounded-full"},null,8,oe),("isTaskSuccess"in o?o.isTaskSuccess:t(E))(s.status)?(c(),u("div",{key:0,class:"absolute left-0 top-0 flex size-full cursor-pointer items-center justify-center overflow-hidden rounded-full bg-foreground/10 px-4 transition-opacity group-hover:opacity-100 md:bg-background/20 md:opacity-0 md:backdrop-blur-lg",onClick:C=>{var l;return(l=t(g))==null?void 0:l.show(s)}},[n(_,{name:"tabler:player-play-filled",size:"20",class:"text-white"})],8,te)):b("",!0),("isTaskFail"in o?o.isTaskFail:t(R))(s.status)?(c(),u("div",{key:1,class:"absolute left-0 top-0 flex size-full cursor-pointer overflow-hidden rounded-full bg-foreground/10 px-4 center md:bg-background/20 md:backdrop-blur",onClick:C=>{var l;return(l=t(g))==null?void 0:l.show(s)}},e[6]||(e[6]=[a("span",{class:"text-xs text-foreground/50"},"失败",-1)]),8,ae)):b("",!0)],2),a("div",ne,[a("h2",le,h(s.title||"--"),1),s.task_id?(c(),u("p",ie,h(s.content||"--"),1)):(c(),u("p",re,[n(L,{variant:"soft",size:"xs"},{default:k(()=>e[7]||(e[7]=[z("来自本地上传")])),_:1})])),a("p",de,[n(_,{name:"tabler:clock-hour-9"}),z(" "+h(s.create_time||"--"),1)])])])],2)]}),_:1},8,["request-instance","polling"]),a("div",ce,[n(O,{ref_key:"detailRef",ref:g},null,512),n(Q,{ref_key:"localUploadRef",ref:v,onRefresh:e[3]||(e[3]=s=>w())},null,512),n(J,{ref_key:"confirmModalRef",ref:x},null,512)])])}}});export{xe as _};
