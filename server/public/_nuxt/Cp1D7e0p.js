import{f as M,u as D,y as g,r as w,h as L,aa as A,ab as F,o as p,A as C,w as i,a as t,b as a,k as l,l as T,ac as j,d,B as b,ad as z,c as P,ae as E,t as v,C as G,D as H,q as I,x as J,af as O}from"./iBiA3qHo.js";import{_ as K,a as Q}from"./CTy8_DAc.js";import{_ as W}from"./C2fI3Sz2.js";import{_ as X}from"./BRU1X883.js";import{d as Y,e as Z}from"./BLDARQqd.js";import{s as ee}from"./BoJhwiBp.js";import{_ as se}from"./DxqbCNiF.js";import{_ as te}from"./izpi8Ziy.js";import{_ as oe}from"./DU3fwEm4.js";import{C as ae}from"./BviGXemD.js";import{u as ne}from"./BK3-fmoW.js";import"./DIFg_cFK.js";import"./jEpb_vT2.js";import"./Cb4KlQxU.js";import"./DluhCU7w.js";import"./DPda_AxG.js";import"./D81t8MNF.js";const le={class:"flex items-center justify-between gap-2"},ie={class:"mb-4"},re={class:"group relative flex cursor-pointer gap-4 rounded-lg bg-background-soft p-4"},de={class:"absolute bottom-0 left-0 z-10 h-0 w-full cursor-pointer overflow-hidden rounded-lg bg-foreground/20 backdrop-blur-lg transition-[height] group-hover:h-10"},ce={class:"flex w-full items-center justify-between px-2 py-2"},ue={class:"relative h-14 w-14 flex-shrink-0"},me=["src"],fe={key:0,class:"absolute inset-0 size-full rounded-full bg-foreground/10 backdrop-blur-sm center dark:bg-background/10"},pe={key:1,class:"absolute inset-0 size-full rounded-full bg-foreground/10 backdrop-blur-sm center dark:bg-background/10"},_e={class:""},ge={class:"line-clamp-1 font-medium"},be={class:"mt-1 line-clamp-2 text-sm text-foreground/60"},ve={class:"mt-1 line-clamp-2 text-xs text-foreground/60"},xe={class:"flex max-h-[80vh] flex-col gap-4 overflow-y-auto"},he={class:"py-2 text-sm leading-7"},ke={class:"flex items-start gap-2"},ye={class:"flex h-7 items-center"},we={class:"flex items-start gap-2"},Ce={class:"flex h-7 items-center"},Te={class:"flex items-start gap-2"},ze={class:"flex h-7 items-center"},Ie=M({__name:"index",setup(Pe){D({title:"我的音色"});const x=g(),c=g(),h=g(),r=w(!1),_=w(""),V=s=>{var e;(e=c.value)==null||e.getList({newParams:{keyword:s},resetPage:!0})},$=async s=>{const e={id:s.id,title:s.name,cover:s.cover,name:"",type:"user"},n=await ae.encrypt(JSON.stringify(e),G.appSrcret);H({path:"/audio/synthesis",query:{voice_data:n}})},k=()=>{r.value=!1},R=s=>{var n;console.log(s);const e=["","1","0","2"];(n=c.value)==null||n.getList({newParams:{status:e[s]},resetPage:!0})};return L(()=>{const s=A("CloneLayout");F(()=>s==null?void 0:s.needRefresh.value,async e=>{e===!0&&ne(async()=>{var n;await((n=c.value)==null?void 0:n.refresh()),s.updateNeedRefresh()})})}),(s,e)=>{const n=I,U=K,S=Q,q=W,m=J,B=O,N=X;return p(),C(N,{breadcrumb:"我的音色",scroll:!0,"mobile-back":!1,padding:!0,background:!0},{"breadcrumb-right":i(()=>[t("div",le,[a(n,{class:"hidden md:order-1 md:flex",icon:"tabler:question-circle",variant:"soft",onClick:e[0]||(e[0]=o=>r.value=!0)},{default:i(()=>e[4]||(e[4]=[t("span",{class:"hidden md:block"},"教程",-1)])),_:1}),a(n,{class:"md:order-1 md:hidden",icon:"tabler:question-circle",variant:"soft",size:"md",onClick:e[1]||(e[1]=o=>r.value=!0)}),a(n,{class:"md:order-1 md:hidden",icon:"tabler:plus",size:"md",to:"/audio/clone/create"}),a(U,{modelValue:l(_),"onUpdate:modelValue":e[2]||(e[2]=o=>T(_)?_.value=o:null),onSearch:V},null,8,["modelValue"])])]),default:i(()=>[t("div",ie,[a(S,{class:"overflow-hidden sm:w-fit",ui:{container:"hidden",list:{tab:{padding:"px-4 sm:px-6",active:"text-primary dark:text-white"}}},items:[{label:"全部"},{label:"完成"},{label:"进行中"},{label:"失败"}],onChange:R})]),a(oe,{ref_key:"listRef",ref:c,"request-instance":l(Z),scroll:!0,polling:o=>o.filter(f=>("isTaskPendding"in s?s.isTaskPendding:l(z))(f.status)).length===0,class:"grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},{default:i(({item:o})=>[t("div",re,[t("div",de,[t("div",ce,[a(n,{icon:"tabler:trash",color:"red",ui:{rounded:"rounded-full"},size:"2xs",onClick:f=>{var u;(u=l(h))==null||u.open({message:`确认要删除 《${o.name}》 吗？`,title:"删除音色",confirm:async()=>{var y;await l(Y)({id:o.id}),(y=l(c))==null||y.getList()}})}},null,8,["onClick"]),("isTaskSuccess"in s?s.isTaskSuccess:l(j))(o.status)?(p(),C(q,{key:0,size:"2xs",orientation:"horizontal",ui:{rounded:"rounded-full"}},{default:i(()=>[a(n,{icon:"heroicons:play",size:"2xs",onClick:f=>{var u;return(u=l(x))==null?void 0:u.open({cover:o.cover,url:o.voice_url})}},{default:i(()=>e[5]||(e[5]=[d(" 试听 ")])),_:2},1032,["onClick"]),a(n,{size:"2xs","trailing-icon":"tabler:chevron-right",onClick:f=>$(o)},{default:i(()=>e[6]||(e[6]=[d(" 使用 ")])),_:2},1032,["onClick"])]),_:2},1024)):b("",!0)])]),t("div",ue,[t("img",{src:o.cover||l(ee),class:"relative size-full rounded-full"},null,8,me),("isTaskPendding"in s?s.isTaskPendding:l(z))(o.status)?(p(),P("div",fe,[a(m,{name:"tabler:loader-2",class:"animate-spin text-white"})])):b("",!0),("isTaskFail"in s?s.isTaskFail:l(E))(o.status)?(p(),P("div",pe,e[7]||(e[7]=[t("span",{class:"text-xs text-foreground/70"},"失败",-1)]))):b("",!0)]),t("div",_e,[t("h2",ge,v(o.name||"--"),1),t("p",be,v(o.record||"--"),1),t("p",ve,v(o.create_time||"--"),1)])])]),_:1},8,["request-instance","polling"]),a(se,{ref_key:"AudioModalRef",ref:x},null,512),a(B,{modelValue:l(r),"onUpdate:modelValue":e[3]||(e[3]=o=>T(r)?r.value=o:null),width:"sm:max-w-lg",title:"合成教程",onClose:k},{default:i(()=>[t("div",xe,[t("div",he,[t("div",ke,[t("div",ye,[a(m,{name:"tabler:hexagon-number-1-filled",class:"flex-shrink-0 text-primary",size:"18"})]),e[8]||(e[8]=d(" 点击创建音色生成录制链接二维码 "))]),t("div",we,[t("div",Ce,[a(m,{name:"tabler:hexagon-number-2-filled",class:"flex-shrink-0 text-primary",size:"18"})]),e[9]||(e[9]=d(" 使用手机扫描二维码，根据页面提示内容完成录制，并按需求填写音色信息，如音色名、头像等 "))]),t("div",Te,[t("div",ze,[a(m,{name:"tabler:hexagon-number-3-filled",class:"flex-shrink-0 text-primary",size:"18"})]),e[10]||(e[10]=d(" 提交保存，点击【我已完成录制，点击关闭】按钮关闭弹窗并刷新列表 "))])]),t("div",{class:"mt-4 center",onClick:k},[a(n,null,{default:i(()=>e[11]||(e[11]=[d("我知道了")])),_:1})])])]),_:1},8,["modelValue"]),a(te,{ref_key:"confirmModalRef",ref:h},null,512)]),_:1})}}});export{Ie as default};
