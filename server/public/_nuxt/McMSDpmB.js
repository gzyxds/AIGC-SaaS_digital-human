import{f as $,W as q,r as p,T as z,X as C,Y as f,bO as B,o as F,A as N,w as n,k as e,l as O,an as I,af as R,b as a,bP as _,a as T,d as j,bR as A,x as D,a7 as G,a8 as M,q as W,a3 as X}from"./iBiA3qHo.js";const Y={class:"flex justify-end gap-2"},J=$({__name:"setPassword",emits:["refresh"],setup(E,{expose:w,emit:v}){const x=v,b=q(),r=p(!1),l=p(!1),i=p(!1),d=p(!1),o=z({password:"",password_confirm:""}),y=C({password:f().min(6,"新密码不能少于6位").required("密码不能为空"),password_confirm:f().min(6,"新密码不能少于6位").required("请再次输入密码").oneOf([B("password")],"两次输入的新密码不一致")}),g=()=>{I(o,{password:"",password_confirm:""}),r.value=!1,l.value=!1,i.value=!0};async function V(){d.value=!0;try{await A(o),b.getUser(),i.value=!1,d.value=!1,x("refresh")}catch{d.value=!1}}return w({open:g}),(U,s)=>{const u=D,m=G,c=M,k=W,S=X,P=R;return F(),N(P,{modelValue:e(i),"onUpdate:modelValue":s[4]||(s[4]=t=>O(i)?i.value=t:null),title:"设置密码"},{default:n(()=>[a(S,{state:e(o),schema:e(y),class:"my-4 space-y-4",onSubmit:V},{default:n(()=>[a(c,{label:"新密码",name:"password",size:"lg",required:""},{default:n(()=>[a(m,{modelValue:e(o).password,"onUpdate:modelValue":s[1]||(s[1]=t=>e(o).password=t),placeholder:"请填写新密码",color:"gray",type:e(r)?"text":"password",class:"flex-1",ui:{icon:{trailing:{pointer:"pointer-events-auto"}}}},_({_:2},[e(o).password?{name:"trailing",fn:n(()=>[a(u,{name:e(r)?"tabler:eye-off":"tabler:eye",class:"cursor-pointer text-foreground/70",size:20,onClick:s[0]||(s[0]=t=>r.value=!e(r))},null,8,["name"])]),key:"0"}:void 0]),1032,["modelValue","type"])]),_:1}),a(c,{label:"确认新密码",name:"password_confirm",size:"lg",required:""},{default:n(()=>[a(m,{modelValue:e(o).password_confirm,"onUpdate:modelValue":s[3]||(s[3]=t=>e(o).password_confirm=t),placeholder:"请再次填写新密码",color:"gray",type:e(l)?"text":"password",class:"flex-1",ui:{icon:{trailing:{pointer:"pointer-events-auto"}}}},_({_:2},[e(o).password_confirm?{name:"trailing",fn:n(()=>[a(u,{name:e(l)?"tabler:eye-off":"tabler:eye",class:"cursor-pointer text-foreground/70",size:20,onClick:s[2]||(s[2]=t=>l.value=!e(l))},null,8,["name"])]),key:"0"}:void 0]),1032,["modelValue","type"])]),_:1}),T("div",Y,[a(k,{type:"submit",class:"px-8",size:"lg",loading:e(d),disabled:!e(o).password||!e(o).password_confirm},{default:n(()=>s[5]||(s[5]=[j(" 立即设置 ")])),_:1},8,["loading","disabled"])])]),_:1},8,["state","schema"])]),_:1},8,["modelValue"])}}});export{J as _};
