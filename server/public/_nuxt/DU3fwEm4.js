import{_ as ae}from"./DluhCU7w.js";import{G as Q,H as E,by as se,_ as Y,f as R,q as W,J as le,K,L as B,o as r,c as g,O as C,A as z,P as $,B as y,F as D,m as J,k as t,b0 as ie,r as M,h as re,$ as ue,bm as de,bL as ce,am as pe,j as fe,b as A,a as q,n as ge,v as G,w as X,l as me,x as ve,d as he,t as ye}from"./iBiA3qHo.js";import{_ as be}from"./D81t8MNF.js";const ke={wrapper:"flex items-center -space-x-px",base:"",rounded:"first:rounded-s-md last:rounded-e-md",default:{size:"sm",activeButton:{color:"primary"},inactiveButton:{color:"white"},firstButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-double-left-20-solid"},lastButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-double-right-20-solid"},prevButton:{color:"white",class:"rtl:[&_span:first-child]:rotate-180",icon:"i-heroicons-chevron-left-20-solid"},nextButton:{color:"white",class:"rtl:[&_span:last-child]:rotate-180",icon:"i-heroicons-chevron-right-20-solid"}}},k=Q(E.ui.strategy,E.ui.pagination,ke),Be=Q(E.ui.strategy,E.ui.button,se),Ce=R({components:{UButton:W},inheritAttrs:!1,props:{modelValue:{type:Number,required:!0},pageCount:{type:Number,default:10},total:{type:Number,required:!0},max:{type:Number,default:7,validate(e){return e>=5&&e<Number.MAX_VALUE}},disabled:{type:Boolean,default:!1},size:{type:String,default:()=>k.default.size,validator(e){return Object.keys(Be.size).includes(e)}},to:{type:Function,default:null},activeButton:{type:Object,default:()=>k.default.activeButton},inactiveButton:{type:Object,default:()=>k.default.inactiveButton},showFirst:{type:Boolean,default:!1},showLast:{type:Boolean,default:!1},firstButton:{type:Object,default:()=>k.default.firstButton},lastButton:{type:Object,default:()=>k.default.lastButton},prevButton:{type:Object,default:()=>k.default.prevButton},nextButton:{type:Object,default:()=>k.default.nextButton},divider:{type:String,default:"…"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(e,{emit:w}){const{ui:O,attrs:l}=le("pagination",K(e,"ui"),k,K(e,"class")),i=B({get(){return e.modelValue},set(a){w("update:modelValue",a)}}),m=B(()=>Array.from({length:Math.ceil(e.total/e.pageCount)},(a,f)=>f+1)),c=B(()=>{const a=m.value.length,f=i.value,j=Math.max(e.max,5),h=Math.floor((Math.min(j,a)-5)/2),u=f-h,V=f+h,U=u-1>1,T=V+1<a,n=[];if(a<=j){for(let d=1;d<=a;d++)n.push(d);return n}if(n.push(1),U&&n.push(e.divider),!T){const d=f+h+2-a;for(let b=f-h-d;b<=f-h-1;b++)n.push(b)}for(let d=Math.max(2,u);d<=Math.min(a,V);d++)n.push(d);if(!U){const d=1-(f-h-2);for(let b=f+h+1;b<=f+h+d;b++)n.push(b)}return T&&n.push(e.divider),V<a&&n.push(a),n.length>=3&&n[1]===e.divider&&n[2]===3&&(n[1]=2),n.length>=3&&n[n.length-2]===e.divider&&n[n.length-1]===n.length&&(n[n.length-2]=n.length-1),n}),o=B(()=>i.value>1),v=B(()=>i.value<m.value.length);function p(){o.value&&(i.value=1)}function I(){v.value&&(i.value=m.value.length)}function S(a){typeof a!="string"&&(i.value=a)}function H(){o.value&&i.value--}function N(){v.value&&i.value++}return{ui:O,attrs:l,currentPage:i,pages:m,displayedPages:c,canGoLastOrNext:v,canGoFirstOrPrev:o,onClickPrev:H,onClickNext:N,onClickPage:S,onClickFirst:p,onClickLast:I}}});function Pe(e,w,O,l,i,m){const c=W;return r(),g("div",$({class:e.ui.wrapper},e.attrs),[C(e.$slots,"first",{onClick:e.onClickFirst,canGoFirst:e.canGoFirstOrPrev},()=>{var o;return[e.firstButton&&e.showFirst?(r(),z(c,$({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.firstButton||{},...e.firstButton},{ui:{rounded:""},"aria-label":"First",onClick:e.onClickFirst}),null,16,["size","to","disabled","class","onClick"])):y("",!0)]}),C(e.$slots,"prev",{onClick:e.onClickPrev,canGoPrev:e.canGoFirstOrPrev},()=>{var o;return[e.prevButton?(r(),z(c,$({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,e.currentPage-1),disabled:!e.canGoFirstOrPrev||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.prevButton||{},...e.prevButton},{ui:{rounded:""},"aria-label":"Prev",onClick:e.onClickPrev}),null,16,["size","to","disabled","class","onClick"])):y("",!0)]}),(r(!0),g(D,null,J(e.displayedPages,(o,v)=>{var p;return r(),z(c,$({key:`${o}-${v}`,to:typeof o=="number"?(p=e.to)==null?void 0:p.call(e,o):null,size:e.size,disabled:e.disabled,label:`${o}`,ref_for:!0},o===e.currentPage?{...e.ui.default.activeButton||{},...e.activeButton}:{...e.ui.default.inactiveButton||{},...e.inactiveButton},{class:[{"pointer-events-none":typeof o=="string","z-[1]":o===e.currentPage},e.ui.base,e.ui.rounded],ui:{rounded:""},onClick:()=>e.onClickPage(o)}),null,16,["to","size","disabled","label","class","onClick"])}),128)),C(e.$slots,"next",{onClick:e.onClickNext,canGoNext:e.canGoLastOrNext},()=>{var o;return[e.nextButton?(r(),z(c,$({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,e.currentPage+1),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.nextButton||{},...e.nextButton},{ui:{rounded:""},"aria-label":"Next",onClick:e.onClickNext}),null,16,["size","to","disabled","class","onClick"])):y("",!0)]}),C(e.$slots,"last",{onClick:e.onClickLast,canGoLast:e.canGoLastOrNext},()=>{var o;return[e.lastButton&&e.showLast?(r(),z(c,$({key:0,size:e.size,to:(o=e.to)==null?void 0:o.call(e,e.pages.length),disabled:!e.canGoLastOrNext||e.disabled,class:[e.ui.base,e.ui.rounded]},{...e.ui.default.lastButton||{},...e.lastButton},{ui:{rounded:""},"aria-label":"Last",onClick:e.onClickLast}),null,16,["size","to","disabled","class","onClick"])):y("",!0)]})],16)}const ze=Y(Ce,[["render",Pe]]),we=R({__name:"pro-pagination",props:{modelValue:{default:()=>({page:1,page_size:10,pedding:!1,count:0,isCompleted:!1})}},emits:["change","update:modelValue"],setup(e,{emit:w}){const O=e,l=w,i=B({get(){return O.modelValue},set(c){l("update:modelValue",c)}}),m=()=>{l("change")};return(c,o)=>{const v=ze;return r(),z(v,{modelValue:t(i).page,"onUpdate:modelValue":[o[0]||(o[0]=p=>t(i).page=p),m],"page-count":t(i).page_size,max:5,total:t(i).count,size:"lg",ui:{rounded:"record-nth-child-2 record-nth-last-child-2",default:{firstButton:{class:"hidden sm:flex"},lastButton:{class:"hidden sm:flex"}}},"prev-button":{icon:"tabler:chevron-left"},"next-button":{icon:"tabler:chevron-right"},"first-button":{icon:"tabler:chevron-left-pipe",color:"gray"},"last-button":{icon:"tabler:chevron-right-pipe",trailing:!0,color:"gray"},"show-first":"","show-last":""},null,8,["modelValue","page-count","total"])}}}),Oe=Y(we,[["__scopeId","data-v-7e96f7d4"]]),Le={key:0,class:"flex-1 py-8 center"},$e={key:1,class:"gap-2 py-8 center"},Ne=["id"],Ve=["id"],Fe={key:3},Me={class:"py-2 center"},je=R({__name:"pro-list",props:{requestInstance:{},mode:{default:void 0},loadMode:{default:"auto"},tiggerHeight:{default:50},class:{default:""},containerClass:{default:""},scroll:{type:Boolean,default:!0},emptyText:{default:"空空如也"},emptyType:{default:"empty"},emptySize:{default:160},polling:{type:[Boolean,Function],default:void 0},paginationClass:{default:""}},emits:["update:state","update:list","refresh","resetPage","resetParams","getList"],setup(e,{expose:w,emit:O}){const l=e,i=ie(),m=M(!1),c=M(!0),o=B(()=>`h-[${l.tiggerHeight}px]`),v=M(!1),p=M("page"),I=M(),S=B(()=>l.class),H=O,{getList:N,list:a,refresh:f,resetPage:j,resetParams:h,state:u}=l.requestInstance(),V=async()=>{var s;(s=document.getElementById(i))==null||s.scroll({top:0,behavior:"smooth"}),await n(),H("getList",a.value)},U=s=>{f(s),l.polling&&d()},T=async s=>{await N(s),l.polling&&d()},n=async()=>{c.value=!0,await N({mode:p.value}),l.polling&&d(),v.value=!0};re(async()=>{p.value=l.mode!==void 0?l.mode:ue()?"load":"page",n(),l.loadMode==="auto"&&de(I,async([{isIntersecting:s}])=>{s&&v.value&&n()},{threshold:.8})});const d=()=>{m.value||(m.value=!0,b())},{start:b,clear:Z}=ce(()=>{c.value=!1,N({mode:p.value,polling:!0})},{stopCondition:typeof l.polling=="function"&&l.polling?()=>l.polling(a.value):l.polling,onEnded:()=>{m.value=!1,c.value=!0}});return pe(()=>{Z()}),w({list:a,getList:T,refresh:U,resetPage:j,resetParams:h,state:u,startPolling:d}),(s,L)=>{const _=ae,x=ve,ee=be,te=Oe,oe=W,ne=fe("load");return r(),g(D,null,[!t(u).pedding&&t(a).length===0?(r(),g("div",Le,[A(_,{type:s.emptyType,text:s.emptyText,size:s.emptySize},null,8,["type","text","size"])])):y("",!0),t(u).pedding&&t(a).length===0&&!t(v)?(r(),g("div",$e,[A(x,{name:"tabler:loader-2",size:"18",class:"animate-spin"}),L[1]||(L[1]=q("span",{class:"text-sm"},"加载中",-1))])):ge((r(),g("div",{key:2,class:G(["flex w-full flex-col",[{"flex-1 overflow-y-auto":s.scroll},s.containerClass]])},[s.scroll&&t(p)==="page"?(r(),z(ee,{key:0},{default:X(()=>[q("div",{id:t(i),class:G(t(S))},[(r(!0),g(D,null,J(t(a),(P,F)=>C(s.$slots,"default",{key:JSON.stringify(P)+F,item:P,index:F})),128))],10,Ne)]),_:3})):(r(),g("div",{key:1,id:t(i),class:G(t(S))},[(r(!0),g(D,null,J(t(a),(P,F)=>C(s.$slots,"default",{key:JSON.stringify(P)+F,item:P,index:F})),128))],10,Ve)),t(p)==="page"&&t(a).length>0?(r(),g("div",{key:2,class:G(s.paginationClass)},[A(te,{modelValue:t(u),"onUpdate:modelValue":L[0]||(L[0]=P=>me(u)?u.value=P:null),class:"mt-4",onChange:V},null,8,["modelValue"])],2)):y("",!0),t(p)==="load"?(r(),g("div",Fe,[s.loadMode==="auto"&&!t(u).isCompleted?(r(),g("div",{key:0,ref_key:"loadMoreTrigger",ref:I,class:G(["pointer-events-none w-full",t(o)])},null,2)):y("",!0),s.loadMode==="manual"&&!t(u).isCompleted?C(s.$slots,"loadTrigger",{key:1},()=>[q("div",Me,[A(oe,{variant:t(u).pedding?"ghost":"soft",color:t(u).pedding?"gray":"primary",size:"xs",loading:t(u).pedding,onClick:n},{default:X(()=>[he(ye(t(u).pedding?"正在加载":"加载更多"),1)]),_:1},8,["variant","color","loading"])])]):y("",!0),t(u).isCompleted&&t(u).count>0?C(s.$slots,"loaded",{key:2},()=>[L[2]||(L[2]=q("p",{class:"py-6 text-center text-xs text-foreground/70"},"没有更多了",-1))]):y("",!0)])):y("",!0)],2)),[[ne,t(u).pedding&&t(p)==="page"&&t(c)]])],64)}}});export{je as _,Oe as a};
