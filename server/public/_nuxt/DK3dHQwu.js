import{_ as j}from"./C6WHBLMF.js";import{f as q,u as F,W as h,y as g,r as C,T as A,h as H,o as u,A as v,w as l,bv as J,b as n,k as t,a as d,t as y,aw as E,B as M,c,p as K,bs as L,d as b,bw as O,bx as P,U as Q,a8 as X,x as Y,q as Z,a7 as ee,a3 as te}from"./iBiA3qHo.js";import{_ as ae}from"./C2fI3Sz2.js";import{_ as ne}from"./BRU1X883.js";import{_ as se}from"./DYEZTXlT.js";import{_ as oe}from"./BqLkR8bs.js";import{_ as le}from"./D7ImzAud.js";import{_ as ie}from"./McMSDpmB.js";import"./DIFg_cFK.js";import"./jEpb_vT2.js";import"./Cb4KlQxU.js";import"./B37HoT1E.js";const re={class:"flex items-center gap-1"},me={class:"text-sm"},ue={class:"flex items-center gap-1"},de={class:"text-sm"},fe={key:0,class:"flex items-center"},pe={class:"text-sm"},ce={key:0,class:"flex items-center gap-1"},_e={class:"text-sm"},ke={key:1},be={key:0,class:"flex items-center gap-1"},xe={key:1},ge={key:0,class:"flex items-center gap-1"},ve={key:1},Ie=q({__name:"profile-edit",emits:["refresh"],setup(ye,{emit:we}){F({title:"编辑资料"});const U=h(),z=g(),w=g(),R=g(),B=g(),$=C(),x=C(!1),i=A({avatar:"",nickname:"",mobile:""}),s=C(),S=async o=>{await P({field:"avatar",value:o.uri}),await U.getUser()},D=async()=>{var o,e;if(x.value=!1,i.nickname===""){Q().warn("用户名不能为空"),i.nickname=(o=s.value)==null?void 0:o.nickname;return}i.nickname!==((e=s.value)==null?void 0:e.nickname)&&(await P({field:"nickname",value:i.nickname}),await U.getUser(),await _())},_=async()=>{s.value=await J(),i.avatar=s.value.avatar,i.nickname=s.value.nickname,i.mobile=s.value.mobile};return H(()=>{_()}),(o,e)=>{const I=j,f=X,V=Y,p=Z,N=ee,T=ae,G=te,W=ne;return u(),v(W,{class:"flex-1",scroll:!0,breadcrumb:"编辑资料",padding:!0,background:!0},{default:l(()=>[n(G,{state:t(i),class:"flex h-full flex-col space-y-4 sm:max-w-sm","validate-on":["submit"]},{default:l(()=>[n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"头像",name:"cover",size:"lg",help:"建议上传10MB以内 1:1 比例的.png、.jpg、.jpeg格式的图片"},{default:l(()=>[n(I,{modelValue:t(i).avatar,"onUpdate:modelValue":e[0]||(e[0]=a=>t(i).avatar=a),class:"h-24 !w-24",type:"image",text:"请选择头像",icon:"tabler:user-circle",square:"","max-size":10,"show-delete":!1,onChange:S},null,8,["modelValue"])]),_:1}),n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"UID",name:"mobile",size:"lg"},{default:l(()=>{var a,m;return[d("div",re,[d("span",me,y((a=t(s))==null?void 0:a.sn),1),(m=t(s))!=null&&m.sn?(u(),v(V,{key:0,name:"tabler:copy",class:"ml-0.5 cursor-pointer",onClick:e[1]||(e[1]=r=>("useCopy"in o?o.useCopy:t(E))(t(s).sn,"已复制UID至剪切板"))})):M("",!0)])]}),_:1}),n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"登录账号",name:"mobile",size:"lg"},{default:l(()=>{var a,m;return[d("div",ue,[d("span",de,y((a=t(s))==null?void 0:a.account),1),(m=t(s))!=null&&m.account?(u(),v(V,{key:0,name:"tabler:copy",class:"ml-0.5 cursor-pointer",onClick:e[2]||(e[2]=r=>("useCopy"in o?o.useCopy:t(E))(t(s).account,"已复制账号至剪切板"))})):M("",!0)])]}),_:1}),n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"昵称",name:"nickname",size:"lg"},{default:l(()=>[t(x)?(u(),v(T,{key:1,size:"lg",orientation:"horizontal",ui:{wrapper:{horizontal:"flex -space-x-px",vertical:"inline-flex flex-col -space-y-px"}}},{default:l(()=>[n(N,{ref_key:"nicknameRef",ref:$,modelValue:t(i).nickname,"onUpdate:modelValue":e[4]||(e[4]=a=>t(i).nickname=a),class:"flex-1",placeholder:"请填写昵称",color:"gray",disabled:!t(x),onBlur:D},null,8,["modelValue","disabled"]),n(p,{icon:"tabler:check",color:"primary",label:"保存"})]),_:1})):(u(),c("div",fe,[d("span",pe,y(t(i).nickname),1),n(p,{variant:"link",icon:"tabler:pencil-minus",onClick:e[3]||(e[3]=async()=>{var a;x.value=!0,await("nextTick"in o?o.nextTick:t(K))(),(a=t($))==null||a.input.focus()})})]))]),_:1}),n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"手机号",name:"mobile",size:"lg"},{default:l(()=>{var a,m;return[(a=t(s))!=null&&a.mobile?(u(),c("div",ce,[d("span",_e,y(("dataMasking"in o?o.dataMasking:t(L))((m=t(s))==null?void 0:m.mobile,6)),1),n(p,{variant:"link",onClick:e[5]||(e[5]=r=>{var k;return(k=t(w))==null?void 0:k.open(t(s))})},{default:l(()=>e[10]||(e[10]=[b("换绑")])),_:1})])):(u(),c("div",ke,[n(p,{variant:"soft",size:"xs",onClick:e[6]||(e[6]=r=>{var k;return(k=t(w))==null?void 0:k.open(t(s))})},{default:l(()=>e[11]||(e[11]=[b("绑定手机号")])),_:1})]))]}),_:1}),n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"登录密码",name:"mobile",size:"lg"},{default:l(()=>{var a;return[((a=t(s))==null?void 0:a.has_password)==!0?(u(),c("div",be,[e[13]||(e[13]=d("span",{class:"text-sm"},"已设置",-1)),n(p,{variant:"link",onClick:e[7]||(e[7]=m=>{var r;return(r=t(R))==null?void 0:r.open(t(s))})},{default:l(()=>e[12]||(e[12]=[b("修改")])),_:1})])):(u(),c("div",xe,[n(p,{variant:"soft",size:"xs",onClick:e[8]||(e[8]=m=>{var r;return(r=t(B))==null?void 0:r.open()})},{default:l(()=>e[14]||(e[14]=[b("点击设置")])),_:1})]))]}),_:1}),n(f,{ui:{label:{base:"text-foreground/50 dark:text-foreground/50"}},label:"微信",name:"mobile",size:"lg"},{default:l(()=>{var a;return[("isEnable"in o?o.isEnable:t(O))((a=t(s))==null?void 0:a.is_auth)?(u(),c("div",ge,e[15]||(e[15]=[d("span",{class:"text-sm"},"已绑定",-1)]))):(u(),c("div",ve,[n(p,{variant:"soft",size:"xs",onClick:e[9]||(e[9]=m=>{var r;return(r=t(z))==null?void 0:r.open()})},{default:l(()=>e[16]||(e[16]=[b("点击绑定")])),_:1})]))]}),_:1})]),_:1},8,["state"]),n(oe,{ref_key:"BindWechatRef",ref:z,onRefresh:_},null,512),n(se,{ref_key:"BindMobileRef",ref:w,onRefresh:_},null,512),n(le,{ref_key:"EditPasswordRef",ref:R,onRefresh:_},null,512),n(ie,{ref_key:"SetPasswordRef",ref:B,onRefresh:_},null,512)]),_:1})}}});export{Ie as default};
