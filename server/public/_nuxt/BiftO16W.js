import{f as P,g as T,W as z,r as c,y as M,aE as U,h as E,a0 as F,cC as G,o as v,c as w,a as n,b as a,w as l,d as i,F as q,m as I,A as O,B as Q,t as g,v as W,cA as $,k as s,D as h,ao as j,aw as H,l as J,af as K,p as X,$ as Y,q as Z,x as ee,e as oe}from"./iBiA3qHo.js";import{_ as te}from"./EjTgL1kZ.js";import{_ as ne}from"./Cb4KlQxU.js";import{i as se}from"./wAdwjX8V.js";import{d as N}from"./75-SRlBf.js";import{u as ae}from"./BCw_9tXi.js";const le={class:"flex flex-1 md:overflow-y-hidden md:rounded-xl md:bg-background"},re={class:"hidden h-full w-44 flex-col gap-4 border-border/40 bg-background p-6 transition-[width] md:flex md:border-r lg:w-52"},ie={class:"flex flex-1 flex-col overflow-y-auto overflow-x-hidden"},de={class:"flex-col center"},ue={class:"flex flex-col items-center gap-2"},pe={class:"text-lg font-bold text-primary"},ce={class:"mt-4 flex items-center gap-4"},_e={class:"mt-4 text-xs text-foreground/50"},we=P({__name:"clone",setup(fe){const x=T(),_=z(),r=c(!1),f=c(!1),k=M();U("CloneLayout",{needRefresh:f,updateNeedRefresh:()=>{f.value=!1}});const u=c(""),V=[{icon:"",path:"/audio/clone",title:"我的音色"},{icon:"",path:"/audio/clone/common",title:"系统音色"}],m=c(),{start:R,stop:y,state:me,next:S,prev:ve}=ae([{element:"#__driver_add__",popover:{title:"点击按钮",description:"点击【创建音色】按钮生成录制二维码",onNextClick:async()=>{r.value=!0,await X(),S()}}},{element:"#__driver_modal__",popover:{title:"扫码录制",description:"使用手机扫描二维码，根据要求进行声音录制，录制完成后点击完成按钮会自动刷新列表"}},{element:"#__driver_confirm__",popover:{title:"完成录制",description:"如果已经完成录制，点击按钮即可关闭弹窗并同时刷新列表",onCloseClick:()=>{r.value=!1,y()},onNextClick:()=>{r.value=!1,y()}}}],{cache:{key:"__voice_clone__",enable:!0}}),B=async()=>{m.value=await N(),Y()?h(`${u.value}&access_token=${_.token}`):r.value=!0};return E(async()=>{m.value=await N(),u.value=F()?`http://192.168.9.117:3333/audio/clone/create?origin=${x.fullPath}`:`${window.location.origin}/audio/clone/create?origin=${x.fullPath}`;const{isMobile:t}=G();t||R()}),(t,e)=>{const p=Z,A=ee,C=oe,D=te,L=ne;return v(),w("div",le,[n("div",re,[a(p,{id:"__driver_add__",block:"",ui:{rounded:"rounded-full"},icon:"tabler:plus",onClick:B},{default:l(()=>e[3]||(e[3]=[i(" 创建音色 ")])),_:1}),(v(),w(q,null,I(V,o=>a(C,{key:o.path,class:W(["flex cursor-pointer items-center gap-2 rounded-lg px-4 py-2 text-sm hover:bg-primary/5",{"bg-primary/10 text-primary":o.path===(t._.provides[$]||t.$route).path||`${o.path}/`===(t._.provides[$]||t.$route).path}]),onClick:()=>{var d;o.path?("navigateTo"in t?t.navigateTo:s(h))(o.path):(d=o.click)==null||d.call(o)}},{default:l(()=>[o.icon?(v(),O(A,{key:0,name:o.icon},null,8,["name"])):Q("",!0),n("span",null,g(o.title),1)]),_:2},1032,["class","onClick"])),64))]),n("div",ie,[a(D)]),a(K,{ref_key:"modalRef",ref:k,modelValue:s(r),"onUpdate:modelValue":e[2]||(e[2]=o=>J(r)?r.value=o:null),"content-id":"__driver_modal__",title:"创建音色"},{default:l(()=>{var o,d;return[n("div",de,[a(s(se),{class:"size-52 rounded-lg",value:`${s(u)}&access_token=${s(_).token}`,color:{dark:"#000000",light:"#ffffff"},type:"image/png"},null,8,["value"]),n("p",ue,[e[5]||(e[5]=n("span",{class:"mt-2 text-xs"},"请使用手机扫码进行录制",-1)),n("span",null,[e[4]||(e[4]=i(" 单次消耗 ")),n("span",pe,g((o=s(m))==null?void 0:o.clone_power),1),i(" "+g((d=("useAppStore"in t?t.useAppStore:s(j))().siteConfig)==null?void 0:d.unit.power),1)])]),n("p",ce,[a(L,null,{default:l(()=>[a(p,{size:"xs",icon:"tabler:copy",onClick:e[0]||(e[0]=()=>("useCopy"in t?t.useCopy:s(H))(`${s(u)}&access_token=${s(_).token}`))},{default:l(()=>e[6]||(e[6]=[i(" 复制链接 ")])),_:1})]),_:1}),a(p,{size:"xs",icon:"tabler:external-link",to:"/audio/clone/create",target:"_blank"},{default:l(()=>e[7]||(e[7]=[i(" 跳转前往 ")])),_:1})]),a(p,{id:"__driver_confirm__",class:"mt-4",ui:{rounded:"rounded-full"},color:"gray",icon:"tabler:circle-check",onClick:e[1]||(e[1]=()=>{var b;(b=s(k))==null||b.close(),f.value=!0})},{default:l(()=>e[8]||(e[8]=[i(" 我已完成录制，点击关闭 ")])),_:1}),n("p",_e,[e[10]||(e[10]=n("span",null,"「扫码」代表同意",-1)),a(C,{target:"_blank",class:"mx-[1px] font-medium text-primary",to:"/agreement?type=agreement&item=use"},{default:l(()=>e[9]||(e[9]=[i(" 《使用协议》 ")])),_:1})])])]}),_:1},8,["modelValue"])])}}});export{we as default};
