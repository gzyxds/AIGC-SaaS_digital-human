import{_ as B,a as D}from"./CTy8_DAc.js";import{f as S,y as c,u as U,r as L,o as u,A as T,w as p,b as n,k as t,l as N,a as o,ae as k,c as P,ar as C,B as b,v,t as h,d as q,a5 as M,ad as x,at as E,q as H,x as j}from"./iBiA3qHo.js";import{_ as G}from"./B8-tLZve.js";import{_ as J,a as K}from"./CQds3MU0.js";import{_ as O}from"./BRU1X883.js";import{f as Q,g as W}from"./DxM3l_Qq.js";import{_ as X}from"./izpi8Ziy.js";import{_ as Y}from"./DU3fwEm4.js";import{_ as Z}from"./BsfnMmz1.js";import"./DPda_AxG.js";import"./DluhCU7w.js";import"./D81t8MNF.js";import"./M2xpECKh.js";import"./75-SRlBf.js";import"./BoJhwiBp.js";const ee={class:"mb-4"},se={class:"relative"},ae={key:0,class:"absolute inset-0 z-10 size-full gap-4 bg-black/10 opacity-0 backdrop-blur transition-opacity center hover:opacity-100"},te={class:"flex flex-col items-center gap-1"},oe={key:0,class:"flex flex-col items-center gap-1"},ne={class:"p-3"},re={class:"flex items-center justify-between"},ie={class:"text-xs text-foreground/60"},le={class:"flex items-center gap-1"},Pe=S({__name:"works",setup(de){const f=c(),w=c(),y=c();U({title:"我的作品"});const l=c(),g=L(""),F=e=>{const a=[[{label:"详情",icon:"i-tabler:info-circle",click:()=>{var r;return(r=f.value)==null?void 0:r.open(e)}}],[{label:"删除",icon:"i-heroicons-trash-20-solid",iconClass:"text-red-500",labelClass:"text-red-500",click:()=>{var r;(r=w.value)==null||r.open({message:`确认要删除 《${e.title}》 吗？`,title:"删除记录",confirm:async()=>{var d;await W({id:e.id}),(d=l.value)==null||d.getList()}})}}]];return e.resultFile&&a[0].push({label:"下载",icon:"i-tabler:download",click:()=>{E({src:e.resultFile})}}),a},R=e=>{var a;(a=l.value)==null||a.getList({newParams:{keyword:e},resetPage:!0})},$=e=>{var r;const a=["","1","0","2"];(r=l.value)==null||r.getList({newParams:{status:a[e]},resetPage:!0})};return(e,a)=>{const r=B,d=D,m=H,z=G,I=j,V=K,A=O;return u(),T(A,{scroll:!0,breadcrumb:"我的作品",padding:!0,background:!0},{"breadcrumb-right":p(()=>[n(r,{modelValue:t(g),"onUpdate:modelValue":a[0]||(a[0]=s=>N(g)?g.value=s:null),onSearch:R},null,8,["modelValue"])]),default:p(()=>[o("div",ee,[n(d,{class:"overflow-hidden sm:w-fit",ui:{container:"hidden",list:{tab:{padding:"px-4 sm:px-6",active:"text-primary dark:text-white"}}},items:[{label:"全部"},{label:"完成"},{label:"进行中"},{label:"失败"}],onChange:$})]),n(Y,{ref_key:"listRef",ref:l,"request-instance":t(Q),scroll:!0,polling:s=>s.filter(_=>("isTaskPendding"in e?e.isTaskPendding:t(x))(_.status)).length===0,class:"grid grid-cols-1 gap-4 p-0.5 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},{default:p(({item:s})=>[o("div",{class:v(["relative flex flex-col overflow-hidden rounded-lg bg-background shadow dark:bg-gray-800",{"opacity-70":("isTaskPendding"in e?e.isTaskPendding:t(x))(s.status)||("isTaskInvalid"in e?e.isTaskInvalid:t(C))(s.status),"bg-red-50 dark:opacity-50":("isTaskFail"in e?e.isTaskFail:t(k))(s.status)}])},[o("div",se,[!("isTaskFail"in e?e.isTaskFail:t(k))(s.status)&&s.resultFile?(u(),P("div",ae,[o("div",te,[n(m,{icon:"i-tabler:player-play-filled",class:"text-white hover:bg-transparent dark:text-white dark:hover:bg-transparent",ui:{rounded:"rounded-full"},size:"lg",variant:"outline",onClick:_=>{var i;return(i=t(y))==null?void 0:i.open(s.resultFile)}},null,8,["onClick"]),a[1]||(a[1]=o("span",{class:"text-xs text-white"},"播放",-1))]),("isTaskInvalid"in e?e.isTaskInvalid:t(C))(s.status)?b("",!0):(u(),P("div",oe,[n(m,{icon:"tabler:dots",class:"text-white hover:bg-transparent dark:text-white dark:hover:bg-transparent",ui:{rounded:"rounded-full"},size:"lg",variant:"outline",onClick:_=>{var i;return(i=t(f))==null?void 0:i.open(s)}},null,8,["onClick"]),a[2]||(a[2]=o("span",{class:"text-xs text-white"},"详情",-1))]))])):b("",!0),n(z,{src:s.cover,class:"bg-background-soft"},null,8,["src"])]),o("div",ne,[o("h1",{class:v(["truncate text-sm",{"text-foreground/80":!s.title}])},h(s.title||"暂无标题"),3),o("div",re,[o("span",ie,h(s.create_time),1),o("div",le,[o("span",{class:v(["whitespace-nowrap rounded-full border-[0.5px] border-foreground/5 bg-foreground/5 px-1.5 py-0.5 text-xs text-foreground/60 center dark:bg-foreground/10",{"bg-red-100 text-red-500/60 dark:text-foreground/60":("isTaskFail"in e?e.isTaskFail:t(k))(s.status)}])},[q(h({0:"合成中",1:("formatSecond"in e?e.formatSecond:t(M))(s.duration),2:"合成失败",null:"已失效"}[s.status])+" ",1),("isTaskPendding"in e?e.isTaskPendding:t(x))(s.status)?(u(),T(I,{key:0,name:"tabler:loader-2",class:"animate-spin text-foreground/70"})):b("",!0)],2),n(V,{ui:{width:"w-20",container:"z-[9999] group",item:{icon:{base:"size-4"},padding:"px-1 py-1"}},items:F(s),popper:{placement:"top-end"}},{default:p(()=>[n(m,{size:"2xs",variant:"ghost",ui:{rounded:"rounded-full",icon:{base:"text-foreground/70"}},icon:"i-tabler:dots-vertical"})]),_:2},1032,["items"])])])])],2)]),_:1},8,["request-instance","polling"]),n(Z,{ref_key:"recordDetailRef",ref:f},null,512),n(X,{ref_key:"confirmModalRef",ref:w},null,512),n(J,{ref_key:"videoPlayerRef",ref:y},null,512)]),_:1})}}});export{Pe as default};
