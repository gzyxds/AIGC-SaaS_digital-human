import{a as z,B as H,A as I,L as S,M as j,g as T,C as Z,h as $,E as G}from"./element-plus-CSiqOtzA.js";import{_ as P}from"./picker-Hc_EAgEs.js";import{d as h}from"./consumer-D7S5nCc8.js";import{u as J}from"./useLockFn-BhPLnZje.js";import{l as K,e as O}from"./lodash-es-R-kYiKr_.js";import{d as Q,r as V,s as W,o as X,L as Y,M as s,V as o,u as t,a as n,S as i,T as v,i as ee}from"./@vue-TMcuEboY.js";import{d as oe}from"./index-B_OJBac2.js";import"./async-validator-DKvM95Vc.js";import"./@element-plus-C2WBhajb.js";import"./dayjs-CMfar2R3.js";import"./balanced-match-mNcR6oh4.js";import"./@ctrl-r5W6hzzQ.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@popperjs-D9SI2xQl.js";import"./index-f_k_jd8c.js";import"./index-DdBWvNAJ.js";import"./index.vue_vue_type_script_setup_true_lang-ggB8NA6X.js";import"./index-DAFrk_EF.js";import"./@vueuse-DE_336rM.js";import"./usePaging-DFi_nJOG.js";import"./vue3-video-play-xg7gp0Bu.js";import"./vuedraggable-OYPBN08G.js";import"./vue-CHxGqOme.js";import"./sortablejs-DdgKbxid.js";import"./nprogress-Cgf5DU8x.js";import"./vue-router-CZY6S6gL.js";import"./pinia-ebUeA1L2.js";import"./axios-C-n2IhIP.js";import"./lodash-BtPWuHkK.js";import"./css-color-function-rJvg8h-6.js";import"./color-B0v57BL7.js";import"./clone-CuIhj1wH.js";import"./color-convert-BGgJB5UM.js";import"./color-name-BQ5IbGbl.js";import"./color-string-BhgG7-8u.js";import"./ms-CzQ2E3wO.js";import"./vue-clipboard3-8CNoFg4V.js";import"./clipboard-Dch_ozqB.js";import"./echarts-BR_QmBtV.js";import"./tslib-BDyQ-Jie.js";import"./zrender-B-CeXLwU.js";import"./highlight.js-D5uP1KGk.js";import"./@highlightjs-KJi31KWJ.js";const le={class:"w-full"},te={class:"text-info text-sm"},ae={class:"w-full"},se=Q({__name:"add",emits:["refresh"],setup(re,{expose:c,emit:g}){const p=V(!1),f=W(),_=V(!1),x={avatar:"",create_time:"",name:"",sn:"",id:"",disable:0,tel:"",tactics:0,domain_alias:"",domain_alias_enable:1,notes:"",account:"",password:"",password_confirm:"",host_name:""},l=V(K(x)),y={name:[{required:!0,message:"请输入租户名称",trigger:["blur"]}],disable:[{required:!0,message:"请选择租户状态",trigger:["blur"]}]},U=g,E=()=>{_.value=!1,p.value=!0},k=r=>{_.value&&r(),O(l.value,x)?r():z.confirm("表单未提交，确认退出编辑吗？").then(()=>{r()}).catch(()=>{})};function w(){const r=window.location.hostname,e=r.split(".");return e.length<=2||/^\d{1,3}(\.\d{1,3}){3}$/.test(r)||r==="localhost"?r:e.slice(-2).join(".")}const C=()=>{var r;(r=f.value)==null||r.resetFields()},A=async()=>{var r;if(await((r=f.value)==null?void 0:r.validate()),l.value.password!==l.value.password_confirm)return G.error("两次密码输入不一致");await h(l.value),_.value=!0,p.value=!1,U("refresh")},B=r=>r?r.split(".").map(e=>e.replace(/[^a-zA-Z0-9-]/g,"").slice(0,32)).filter(e=>e&&!/^-|-$/.test(e)).join("."):"",F=r=>r?r.replace(/\s+/g,"").replace(/[^a-zA-Z0-9-.]/g,""):"",{isLock:R,lockFn:D}=J(A);return c({openHandle:E}),(r,e)=>{const N=P,m=H,d=I,u=S,b=j,L=T,M=Z,q=$;return X(),Y(q,{modelValue:t(p),"onUpdate:modelValue":e[11]||(e[11]=a=>ee(p)?p.value=a:null),title:"新增租户",direction:"rtl",size:"50%","destroy-on-close":!0,"before-close":k,onClose:C},{default:s(()=>[o(M,{ref_key:"formRef",ref:f,class:"ls-form","label-position":"right",model:t(l),rules:y,"label-width":"130px"},{default:s(()=>[e[19]||(e[19]=n("div",{class:"form_header"},"基础信息",-1)),o(m,{label:"租户头像：",prop:"avatar"},{default:s(()=>[o(N,{modelValue:t(l).avatar,"onUpdate:modelValue":e[0]||(e[0]=a=>t(l).avatar=a),limit:1},null,8,["modelValue"])]),_:1}),o(m,{label:"租户名称：",prop:"name"},{default:s(()=>[o(d,{modelValue:t(l).name,"onUpdate:modelValue":e[1]||(e[1]=a=>t(l).name=a),placeholder:"请输入租户名称",style:{width:"280px"}},null,8,["modelValue"])]),_:1}),o(m,{label:"租户状态：",prop:"disable"},{default:s(()=>[o(b,{modelValue:t(l).disable,"onUpdate:modelValue":e[2]||(e[2]=a=>t(l).disable=a)},{default:s(()=>[o(u,{value:0},{default:s(()=>e[12]||(e[12]=[i("开启")])),_:1}),o(u,{value:1},{default:s(()=>e[13]||(e[13]=[i("关闭")])),_:1})]),_:1},8,["modelValue"])]),_:1}),o(m,{label:"联系方式：",prop:"tel"},{default:s(()=>[o(d,{modelValue:t(l).tel,"onUpdate:modelValue":e[3]||(e[3]=a=>t(l).tel=a),maxlength:30,placeholder:"请输入联系方式",style:{"max-width":"280px"}},null,8,["modelValue"])]),_:1}),o(m,{label:"自定义主机名：",prop:"host_name"},{default:s(()=>[n("div",le,[o(d,{modelValue:t(l).host_name,"onUpdate:modelValue":e[4]||(e[4]=a=>t(l).host_name=a),placeholder:"请输入主机名",style:{"max-width":"280px"},formatter:B,parser:F},{append:s(()=>[i("."+v(w()),1)]),_:1},8,["modelValue"]),n("p",te," 设置默认主机名，例：tenant001."+v(w())+"，不填则由系统随机生成 ",1)])]),_:1}),o(m,{label:"租户自定义域名：",prop:"domain_alias"},{default:s(()=>[n("div",ae,[o(d,{modelValue:t(l).domain_alias,"onUpdate:modelValue":e[5]||(e[5]=a=>t(l).domain_alias=a),placeholder:"请输入租户自定义域名",style:{"max-width":"280px"}},null,8,["modelValue"]),e[14]||(e[14]=n("p",{class:"text-info text-sm"}," 设置租户自定义域名，例如：https://www.example.com ",-1))])]),_:1}),o(m,{label:"启用自定义域名：",prop:"domain_alias_enable"},{default:s(()=>[n("div",null,[o(b,{modelValue:t(l).domain_alias_enable,"onUpdate:modelValue":e[6]||(e[6]=a=>t(l).domain_alias_enable=a)},{default:s(()=>[o(u,{value:0},{default:s(()=>e[15]||(e[15]=[i("启用")])),_:1}),o(u,{value:1},{default:s(()=>e[16]||(e[16]=[i("禁用")])),_:1})]),_:1},8,["modelValue"]),e[17]||(e[17]=n("p",{class:"text-info text-sm"}," 需将别名解析到默认域名并将别名配置到租户站点后生效 ",-1))])]),_:1}),o(m,{label:"租户备注：",prop:"notes"},{default:s(()=>[o(d,{modelValue:t(l).notes,"onUpdate:modelValue":e[7]||(e[7]=a=>t(l).notes=a),placeholder:"请输入租户备注",style:{"max-width":"280px"},type:"textarea",maxlength:100},null,8,["modelValue"])]),_:1}),e[20]||(e[20]=n("div",{class:"form_header"},[i(" 账号信息 "),n("span",{class:"text-xs font-normal text-info opacity-70"}," （不填则生成默认账号，账号默认为sn编码，密码默认a123456） ")],-1)),o(m,{label:"管理员账号：",prop:"account"},{default:s(()=>[o(d,{modelValue:t(l).account,"onUpdate:modelValue":e[8]||(e[8]=a=>t(l).account=a),placeholder:"请输入管理员账号",style:{"max-width":"280px"}},null,8,["modelValue"])]),_:1}),o(m,{label:"密码：",prop:"password"},{default:s(()=>[o(d,{modelValue:t(l).password,"onUpdate:modelValue":e[9]||(e[9]=a=>t(l).password=a),type:"password",placeholder:"请输入密码",style:{"max-width":"280px"}},null,8,["modelValue"])]),_:1}),o(m,{label:"确认密码：",prop:"password_confirm"},{default:s(()=>[o(d,{modelValue:t(l).password_confirm,"onUpdate:modelValue":e[10]||(e[10]=a=>t(l).password_confirm=a),type:"password",placeholder:"请再次输入密码",style:{"max-width":"280px"}},null,8,["modelValue"])]),_:1}),o(m,null,{default:s(()=>[o(L,{type:"primary",loading:t(R),onClick:t(D)},{default:s(()=>e[18]||(e[18]=[i("提交")])),_:1},8,["loading","onClick"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),Qe=oe(se,[["__scopeId","data-v-b6f5227d"]]);export{Qe as default};
