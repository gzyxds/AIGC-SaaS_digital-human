"use strict";const e=require("../common/vendor.js"),n=require("../utils/client.js"),o=require("./useAudio.js");exports.useRecording=function(){const r=e.ref(!1),l=e.ref(""),a=e.ref(0);let i=null;const{play:u,pause:t,isPlaying:s}=o.useAudio(),c=()=>{if(r.value){e.index.getRecorderManager().stop();i&&(clearInterval(i),i=null),r.value=!1}};return e.onMounted((()=>{})),e.onUnmounted((()=>{r.value&&c()})),{isRecording:r,audioFilePath:l,recordingDuration:a,startRecording:async()=>{if(!r.value){console.log("是否为微信小程序环境",n.isMPWeixinClient());{const n=e.index.getRecorderManager();n.start({format:"mp3"}),n.onStop((e=>{l.value=e.tempFilePath}))}i=setInterval((()=>{a.value+=1}),1e3),r.value=!0}},stopRecording:c,resetRecording:()=>{r.value&&c(),a.value=0,l.value=""},playRecording:()=>{l.value?(console.log("录音文件路径",l.value),u(l.value)):console.error("录音文件路径为空")},pauseRecording:()=>{s.value&&t()},isPlaying:s}};
