"use strict";const e=require("../../utils/util.js"),o=require("../../common/vendor.js"),n=require("../../common/assets.js"),t=require("../../api/article.js"),a=require("../../api/avatar.js"),i=require("../../api/common.js"),s=require("../../stores/app.js"),l=require("../../utils/check.js"),r=require("../../composables/usePollingTask.js");if(!Array){((()=>"../../components/TitleContent.js")+(()=>"../../components/ProductCard.js")+(()=>"../../components/ArticleCard.js")+(()=>"../../components/Tabbar.js")+o.resolveComponent("layout-auth-uni"))()}const u=o.defineComponent({__name:"index",setup(u){const d=s.useAppStore(),p=o.ref([]),c=o.ref([]),g=o.ref([]),m=o.ref([]);let v;const f=async e=>{console.log("开始轮询");const{start:n,clear:t}=r.usePollingTask((async n=>{const{lists:t}=await a.apiGetAiAvatarList({page_no:1,page_size:e});t.forEach(((e,n)=>{l.isTaskPendding(c.value[n].status)&&!o.isEqual(e.status,c.value[n].status)&&(c.value[n]=e)})),0===t.filter((e=>l.isTaskPendding(e.status))).length&&n()}));v=t,n()},_=e=>{o.index.navigateTo({url:e})};return o.onShow((()=>{(async()=>{const e=await t.apiGetArticleList({page_no:1,page_size:10});p.value=e.lists})(),(async()=>{const e=await a.apiGetAiAvatarList({page_no:1,page_size:5});c.value=e.lists,c.value.filter((e=>l.isTaskPendding(e.status))).length&&f(5)})(),(async()=>{var e,o;const n=await i.apiGetIndexDecorateConfig({type:1});console.log("首页装修数据 =>",JSON.parse(n.data)),g.value=JSON.parse(n.data),m.value=(null==(o=null==(e=g.value[0])?void 0:e.content)?void 0:o.data)||[]})(),console.log("首页onBeforeUpdate执行")})),o.onBeforeUpdate((()=>{console.log("首页onBeforeUpdate执行")})),o.onLoad((()=>{console.log("首页onLoaded执行")})),o.onMounted((()=>{console.log("首页onMounted执行")})),o.onBeforeUnmount((()=>{v&&v()})),o.onShareAppMessage((e=>{var o,n,t;return"button"===e.from?console.log("来自页面内转发按钮"):"menu"===e.from&&console.log("右上角菜单转发按钮"),{title:(null==(n=null==(o=null==d?void 0:d.siteConfig)?void 0:o.website)?void 0:n.shop_name)||"AI数字人",path:"/pages/home/index",imageUrl:(null==(t=null==d?void 0:d.siteConfig)?void 0:t.share_image)||""}})),o.onShareTimeline((()=>{var e,o,n,t;return{title:(null==(o=null==(e=null==d?void 0:d.siteConfig)?void 0:e.website)?void 0:o.shop_name)||"AI数字人",path:"/pages/home/index",imageUrl:(null==(t=null==(n=null==d?void 0:d.siteConfig)?void 0:n.website)?void 0:t.shop_logo)||""}})),(t,a)=>o.e({a:o.f(o.unref(m),((n,a,i)=>({a:("joinUrl"in t?t.joinUrl:o.unref(e.joinUrl))(n.image),b:n}))),b:o.o((e=>_("/pages/digital_people/index"))),c:n._imports_0,d:o.o((e=>_("/pages/create_profile/index"))),e:n._imports_1,f:o.o((e=>_("/pages/create_sound/index"))),g:o.unref(c).length},o.unref(c).length?{h:o.o((e=>{return n="/pages/product/index",void o.index.switchTab({url:n});var n})),i:o.p({title:"我的作品"}),j:o.f(o.unref(c),((e,n,t)=>({a:o.t(e.title),b:"199b4e36-2-"+t+",199b4e36-0",c:o.p({images:e.cover,time:e.duration,url:e.resultFile,status:e.status,"fail-reason":e.fail_reason,"image-width":"288rpx","image-height":"384rpx"}),d:e.id})))}:{},{k:o.o((e=>_("/bundle/pages/article/index"))),l:o.p({title:"文章资讯"}),m:o.f(o.unref(p),((e,n,t)=>({a:e.id,b:"199b4e36-4-"+t+",199b4e36-0",c:o.p({data:e})}))),n:o.p({current:0})})}});u.__runtimeHooks=6;const d=o._export_sfc(u,[["__scopeId","data-v-199b4e36"]]);wx.createPage(d);
