"use strict";const e=require("../../common/vendor.js"),o=require("../../api/user.js"),r=require("../../enums/variableEnum.js"),s=require("../../composables/useToast.js"),n=()=>"../VerificationCode.js";if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+n+e.resolveComponent("uni-forms"))()}Math||((()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-easyinput/uni-easyinput.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-forms-item/uni-forms-item.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-forms/uni-forms.js"))();const i=e.defineComponent({__name:"Register",props:{type:{type:String,default:"6"},isAgreement:{type:Boolean},agreementPopupRef:{type:Object}},emits:["register"],setup(n,{emit:i}){const u=n,a=i,t=e.ref(!1),l=e.ref(),p=e.ref({account:"",password:"",password_confirm:"",code:""}),d={account:{rules:[{required:!0,errorMessage:"请输入账号/手机号"}]},code:{rules:[{required:!0,errorMessage:"请输入验证码"}]},password:{rules:[{required:!0,errorMessage:"请输入密码"}]},password_confirm:{rules:[{required:!0,errorMessage:"请再次输入新密码"}]}},c=()=>{p.value.account?(t.value=!0,o.apiPostSendCode({mobile:p.value.account,scene:r.CodeTypeEnum.MOBILE_REGISTER}),console.log("发送获取验证码请求")):e.index.showToast({title:"请输入手机号",icon:"none"})},m=async()=>{if(!u.isAgreement)return void u.agreementPopupRef.open();const r=await l.value.validate();if(console.log("表单校验通过",r),p.value.password!==p.value.password_confirm)return void s.useToast("两次输入的密码不一致");const{code:n}=await e.index.login({provider:"weixin"});await o.apiPostAccountRegister({...p.value,code:n,scene:"7"===u.type?2:3}),a("register")};return(o,r)=>e.e({a:e.o((o=>e.unref(p).account=o)),b:e.p({"prefix-icon":"person",placeholder:"请输入账号",modelValue:e.unref(p).account}),c:e.p({label:"",name:"account"}),d:"7"===n.type},"7"===n.type?{e:e.o(c),f:e.o((o=>e.isRef(t)?t.value=o:null)),g:e.p({second:59,"countdown-switch":e.unref(t)}),h:e.o((o=>e.unref(p).code=o)),i:e.p({"prefix-icon":"person",placeholder:"请输入验证码",modelValue:e.unref(p).code}),j:e.p({label:"",name:"code"})}:{},{k:e.o((o=>e.unref(p).password=o)),l:e.p({type:"password","prefix-icon":"locked",placeholder:"请输入密码",modelValue:e.unref(p).password}),m:e.p({label:"",name:"password"}),n:e.o((o=>e.unref(p).password_confirm=o)),o:e.p({type:"password","prefix-icon":"locked",placeholder:"请再次输入密码",modelValue:e.unref(p).password_confirm}),p:e.p({label:"",name:"password_confirm"}),q:e.sr(l,"1b5b388e-0",{k:"formRef"}),r:e.p({"model-value":e.unref(p),rules:d}),s:e.o((e=>o.$emit("register"))),t:e.o(m)})}});wx.createComponent(i);
