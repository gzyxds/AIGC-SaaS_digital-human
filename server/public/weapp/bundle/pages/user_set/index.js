"use strict";const e=require("../../../common/vendor.js"),o=require("../../../api/user.js"),n=require("../../../composables/useRequest.js"),r=require("../../../stores/user.js");if(!Array){((()=>"../../../components/ConfirmModal.js")+e.resolveComponent("layout-default-uni"))()}const a=e.defineComponent({__name:"index",setup(a){const s=r.useUserStore(),i=e.ref();function l(){s.logout(),e.index.switchTab({url:"/pages/user/index"})}function t(o){var r;o.detail.avatarUrl&&(console.log("微信头像 e.detail.avatarUrl =>",o.detail.avatarUrl),r=o.detail.avatarUrl,n.useUpload({type:"image",data:{file:r},success:e=>{console.log("头像上传成功",e),u(e.uri)},fail:e=>{console.log("头像上传失败",e)}}).onProgressUpdate((o=>{e.index.showLoading({title:`上传中${o.progress}%`}),console.log("上传进度：",`${o.progress}%`),100===o.progress&&e.index.hideLoading()})))}const u=async e=>{await o.apiPostSetUserInfoSingle({field:"avatar",value:e}),s.getUser()},d=o=>e.index.navigateTo({url:o});return e.onMounted((()=>{s.getUser()})),(o,n)=>{var r,a,u,c,f;return{a:null==(r=e.unref(s).userInfo)?void 0:r.avatar,b:e.o(t),c:e.o(t),d:e.t(null==(a=e.unref(s).userInfo)?void 0:a.nickname),e:e.o((e=>d("/bundle/pages/change_nickname/index"))),f:e.t((null==(u=e.unref(s).userInfo)?void 0:u.mobile)?`+86 ${null==(c=e.unref(s).userInfo)?void 0:c.mobile}`:"未绑定"),g:e.o((e=>d("/bundle/pages/change_mobile/index?mobile"))),h:e.t((null==(f=e.unref(s).userInfo)?void 0:f.has_password)?"已设置":"未设置"),i:e.o((e=>d("/bundle/pages/change_password/index"))),j:e.o((o=>e.unref(i).open())),k:e.sr(i,"4fc351cd-1,4fc351cd-0",{k:"confirmModalRef"}),l:e.p({title:"温馨提示",content:"确定退出当前登录吗?","confirm-callback":l})}}}}),s=e._export_sfc(a,[["__scopeId","data-v-4fc351cd"]]);wx.createPage(s);
