import{d as a,aF as e,r as s,j as l,aK as o,G as r,J as d,l as u,o as n,c as p,w as t,N as i,X as m,Y as f,a as w,q as c,s as _,b as v,ac as y,bm as x,bn as V,x as b,y as h,i as k}from"./index-CTSv8bdf.js";const g=a({__name:"index",setup(a){const g=e(),q=s({password:"",password_confirm:"",old_password:""}),I=s(),M={password:{rules:[{required:!0,errorMessage:"请输入新密码"}]},password_confirm:{rules:[{required:!0,errorMessage:"请确认新密码"}]},old_password:{rules:[{required:!0,errorMessage:"请输入原密码"}]}},U=async()=>{var a;await I.value.validate(),q.value.password===q.value.password_confirm?((null==(a=g.userInfo)?void 0:a.has_password)?await x(q.value):await V(q.value),g.logout(),setTimeout((()=>{b({url:"/pages/user/index"})}),500)):y({title:"两次输入的密码不一致",icon:"error"})};return l((()=>{var a;o({title:(null==(a=g.userInfo)?void 0:a.has_password)?"修改密码":"设置密码"})})),(a,e)=>{const s=r(d("uni-easyinput"),i),l=r(d("uni-forms-item"),m),o=r(d("uni-forms"),f),y=h,x=k,V=u("layout-default-uni");return n(),p(V,null,{default:t((()=>[w(x,{"px-3":"","pt-7":""},{default:t((()=>[w(o,{ref_key:"formRef",ref:I,"model-value":q.value,rules:M},{default:t((()=>{var a;return[w(l,{label:"",name:"password"},{default:t((()=>[w(s,{modelValue:q.value.password,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value.password=a),type:"password",placeholder:"请输入新密码","prefix-icon":"locked"},null,8,["modelValue"])])),_:1}),w(l,{label:"",name:"confirmPassword"},{default:t((()=>[w(s,{modelValue:q.value.password_confirm,"onUpdate:modelValue":e[1]||(e[1]=a=>q.value.password_confirm=a),type:"password",placeholder:"请确认新密码","prefix-icon":"locked"},null,8,["modelValue"])])),_:1}),(null==(a=c(g).userInfo)?void 0:a.has_password)?(n(),p(l,{key:0,label:"",name:"oldPassword"},{default:t((()=>[w(s,{modelValue:q.value.old_password,"onUpdate:modelValue":e[2]||(e[2]=a=>q.value.old_password=a),type:"password",placeholder:"请输入原密码","prefix-icon":"locked"},null,8,["modelValue"])])),_:1})):_("",!0)]})),_:1},8,["model-value"]),w(y,{type:"primary","mt-14":"",onClick:U},{default:t((()=>[v("确定")])),_:1})])),_:1})])),_:1})}}});export{g as default};
