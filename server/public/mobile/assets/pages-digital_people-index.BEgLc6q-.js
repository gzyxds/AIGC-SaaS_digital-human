import{d as e,r as a,L as l,a4 as o,W as t,x as r,h as d,a5 as u,G as n,J as i,l as s,o as p,c as m,w as c,a7 as v,a8 as f,a9 as _,N as x,X as g,Y as b,a as y,s as h,b as k,t as w,Z as j,O as I,q as R,v as T,aa as C,ab as E,ac as P,e as U,i as V,U as S,y as A,z as M,_ as N}from"./index-CTSv8bdf.js";import{_ as q}from"./uni-data-select.Buo78M34.js";import{_ as F}from"./mp-html.DNKTp127.js";import{_ as G}from"./icon-image.CWyGkq44.js";import{_ as L}from"./icon-sound.D7rZqbzE.js";import{c as z}from"./avatar.D4ZfpDUd.js";import{a as Y}from"./power.B2nVI0bR.js";import D from"./pages-digital_people-components-SelectProfilePop.BNG1OrVm.js";import J from"./pages-digital_people-components-SelectTonePop.Daeo_it8.js";import"./index.BEstvkTC.js";import"./EmptyStatus.vue_vue_type_script_setup_true_lang.BbsBdioH.js";import"./ProductCard.pVvRNm7o.js";import"./z-paging.DcYRLe5r.js";import"./icon-select.ChgqfciC.js";import"./icon-sound-play.BP2LNVwo.js";import"./useAudio.-uo5Ft4D.js";const $=N(e({__name:"index",setup(e){const N=a(),$=a(),H=a(),K=l(),O=a(),W=a(""),X=a(),Z=a({voice_mode:1,voice_id:"",content:"",timbre:"",video_id:"",video_mode:null,video_name:""}),B={video_name:{rules:[{required:!0,errorMessage:"请输入数字人名称"}]},video_mode:{rules:[{required:!0,errorMessage:"请选择合成模式"}]},content:{rules:[{required:!0,errorMessage:"请输入需要合成的文本内容"}]}},Q=o((()=>Z.value.content.length));o((()=>{var e;return(null==(e=ee.value.find((e=>e.value===Z.value.video_mode)))?void 0:e.video_power)||0}));const ee=a([{value:0,text:"极速模式",disable:!1,video_power:0},{value:1,text:"普通模式",disable:!1,video_power:0}]),ae=()=>{T({url:"/bundle/pages/agreement/index?type=use"})},le=()=>Z.value.video_id?Z.value.voice_id?void X.value.validate().then((e=>{var a;console.log("表单校验通过",e),null==(a=K.value)||a.open()})).catch((e=>{console.log("表单校验失败",e)})):P({title:"请选择音色",icon:"none"}):P({title:"请选择形象",icon:"none"}),oe=t((async()=>{try{await z({...Z.value,timbre:null}),console.log("创建请求成功"),r({url:"/pages/product/index"})}catch(e){console.log("创建请求失败",e)}}),800);return d((e=>{console.log("options =>",e),(null==e?void 0:e.profileId)&&(Z.value.video_id=null==e?void 0:e.profileId,H.value=null==e?void 0:e.profileImage),(null==e?void 0:e.soundId)&&(Z.value.voice_id=null==e?void 0:e.soundId,Z.value.timbre=null==e?void 0:e.soundName),u((async()=>{await(async()=>{const e=await C(E.USE);console.log("协议 =>",e),W.value=e.content})();v(f.CREATE_DIGITAL_FIRST_ENTRY)||(O.value.open(),_(f.CREATE_DIGITAL_FIRST_ENTRY,!0)),(async()=>{const e=await Y();console.log("算力配置 =>",e),ee.value=e.map((e=>({value:e.mode,text:`${e.video_mode_title}（${e.video_power}算力/分钟）`,disable:0===e.video_mode_status,video_power:e.video_power})))})()}))})),(e,a)=>{const l=U,o=V,t=n(i("uni-easyinput"),x),r=n(i("uni-forms-item"),g),d=S,u=n(i("uni-data-select"),q),v=n(i("uni-forms"),b),f=A,_=n(i("mp-html"),F),T=M,C=s("layout-default-uni");return p(),m(C,null,{default:c((()=>[y(o,{class:"digital-people h-full px-[24rpx] py-[16rpx]"},{default:c((()=>[y(o,{class:"mx-[76rpx] h-[796rpx] flex flex-col items-center justify-center rounded-[48rpx] bg-background",onClick:a[0]||(a[0]=e=>N.value.open(Z.value.video_id||""))},{default:c((()=>[H.value?(p(),m(l,{key:0,"h-796rpx":"","w-550rpx":"","rounded-48rpx":"",src:H.value,mode:"aspectFit"},null,8,["src"])):h("",!0),H.value?h("",!0):(p(),m(l,{key:1,src:G,class:"h-[80rpx] w-[80rpx]"})),H.value?h("",!0):(p(),m(o,{key:2,"mt-12rpx":"",text:"3.5 foreground-muted","font-400":""},{default:c((()=>[k(" 选择我的形象 ")])),_:1}))])),_:1}),y(v,{ref_key:"formRef",ref:X,"model-value":Z.value,rules:B},{default:c((()=>[y(o,{"mx-24rpx":"","mt-10":""},{default:c((()=>[y(r,{label:"",name:"video_name"},{default:c((()=>[y(t,{modelValue:Z.value.video_name,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value.video_name=e),placeholder:"请输入数字人名称",type:"text"},null,8,["modelValue"])])),_:1})])),_:1}),y(o,{class:"mx-[24rpx] mt-10 rounded-[28rpx] bg-background p-[24rpx]"},{default:c((()=>[y(o,{class:"mb-2 w-fit center rounded-[28rpx] bg-background-muted p-1 pr-[16rpx]",onClick:a[2]||(a[2]=e=>$.value.open(Z.value.voice_id||""))},{default:c((()=>[y(l,{src:L,class:"h-[64rpx] w-[64rpx]"}),Z.value.timbre?h("",!0):(p(),m(o,{key:0,"ml-12rpx":"",text:"base foreground-muted"},{default:c((()=>[k(" 选择音色 ")])),_:1})),Z.value.timbre?(p(),m(o,{key:1,"ml-12rpx":"",text:"base foreground-muted"},{default:c((()=>[k(w(Z.value.timbre),1)])),_:1})):h("",!0),y(o,{"i-tabler:chevron-right":"","text-foreground-placeholder":""})])),_:1}),y(o,null,{default:c((()=>[y(r,{label:"",name:"content"},{default:c((()=>[y(d,{modelValue:Z.value.content,"onUpdate:modelValue":a[3]||(a[3]=e=>Z.value.content=e),modelModifiers:{trim:!0},type:"textarea",placeholder:"请输入需要合成的文本内容",maxlength:900},null,8,["modelValue"])])),_:1}),y(o,{"mt-3":"",end:""},{default:c((()=>[y(o,null,{default:c((()=>[j("span",{text:"base primary","mr-2.5":"",onClick:a[4]||(a[4]=e=>Z.value.content="")},"清空"),j("span",{text:"3.5 foreground-placeholder"},w(Q.value)+"/900",1)])),_:1})])),_:1})])),_:1})])),_:1}),y(o,{class:"mx-[24rpx] mt-10"},{default:c((()=>[y(o,{"mb-24rpx":"","ml-32rpx":"",text:"base foreground-placeholder"},{default:c((()=>[k(" 合成模式 ")])),_:1}),y(r,{label:"",name:"video_mode"},{default:c((()=>[y(u,{modelValue:Z.value.video_mode,"onUpdate:modelValue":a[5]||(a[5]=e=>Z.value.video_mode=e),localdata:ee.value,placeholder:"请选择合成模式",placement:"top",clear:!0},null,8,["modelValue","localdata"])])),_:1})])),_:1})])),_:1},8,["model-value"]),y(o,{class:"footer","position-fixed":"","bottom-0":"","left-0":"","z-2":"","w-full":"","bg-background":"","p-3":""},{default:c((()=>[y(f,{type:"primary",onClick:le},{default:c((()=>[k("创建数字人")])),_:1}),y(o,{"mt-24rpx":"","text-center":"","text-28rpx":"","font-400":""},{default:c((()=>[j("span",{"text-foreground-muted":""},"我已知晓并同意"),j("span",{"text-primary":"",onClick:ae},"《使用协议》")])),_:1})])),_:1}),y(D,{ref_key:"selectProfilePopRef",ref:N,"profile-id":Z.value.video_id,"onUpdate:profileId":a[6]||(a[6]=e=>Z.value.video_id=e),"profile-image":H.value,"onUpdate:profileImage":a[7]||(a[7]=e=>H.value=e)},null,8,["profile-id","profile-image"]),y(J,{ref_key:"selectTonePopRef",ref:$,"sound-id":Z.value.voice_id,"onUpdate:soundId":a[8]||(a[8]=e=>Z.value.voice_id=e),"sound-name":Z.value.timbre,"onUpdate:soundName":a[9]||(a[9]=e=>Z.value.timbre=e)},null,8,["sound-id","sound-name"]),y(I,{ref_key:"payPopupRef",ref:K,title:"创建数字人","cancel-text":"取消","confirm-text":"继续","confirm-callback":R(oe)},{default:c((()=>[y(o,{"text-foreground-light":""},{default:c((()=>[k(" 是否继续? ")])),_:1})])),_:1},8,["confirm-callback"]),y(I,{ref_key:"agreementPopupRef",ref:O,title:"使用协议","show-cancel":!1,"is-mask-click":!1,"confirm-text":"我已知晓并同意"},{default:c((()=>[y(T,{"scroll-y":!0,class:"h-800rpx"},{default:c((()=>[y(o,{"text-left":"","text-foreground-light":""},{default:c((()=>[y(_,{content:W.value},null,8,["content"])])),_:1})])),_:1})])),_:1},512)])),_:1})])),_:1})}}}),[["__scopeId","data-v-512a69c0"]]);export{$ as default};
